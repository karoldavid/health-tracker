var app=app||{};app.Food=Backbone.Model.extend({idAttribute:"_id",defaults:{id:"",name:"",fat:0,carbs:0,protein:0,calories:0},parse:function(e){if("undefined"!=typeof e.fields){var a={};return a.id=e._id,a.name=e.fields.item_name,a.calories=e.fields.nf_calories,a.fat=e.fields.nf_total_fat,a.carbs=e.fields.nf_total_carbohydrate,a.protein=e.fields.nf_protein,a}return e}});
var app=app||{};app.Item=Backbone.Model.extend({defaults:{}});
var app=app||{};app.List=Backbone.Collection.extend({model:app.Item,query:"",url:"https://api.nutritionix.com/v1_1/item/apple?appId=45d2f648&appKey=554a56cde5749526f1c5bb56190fda39",parse:function(p){return p.hits},sync:function(p,a,e){var t=this,n=_.extend({type:"GET",url:t.url,processData:!1},e);return $.ajax(n)}});
var app=app||{};app.MyFoodList=Backbone.Collection.extend({model:app.Food}),app.myfoodlist=new app.MyFoodList;
var app=app||{};app.ListView=Backbone.View.extend({el:$("#search"),events:{"keyup input":"getResults","click i":"resetSearch"},initialize:function(){_.bindAll(this,"render","getResults"),this.collection=new app.List,this.results=$("#searchResults"),this.myFood=$("#myFood"),this.render()},render:function(){this.results.empty();var e=this,t=e.collection.toJSON();t.forEach(function(t){e.renderListItem(t)})},renderListItem:function(e){var t=new app.ListitemView({model:e});this.results.append(t.render().el)},getResults:function(e){e.preventDefault();var t=$("input").val(),i=this,s="https://api.nutritionix.com/v1_1/search/"+t+"?results=0:5&appId=45d2f648&appKey=554a56cde5749526f1c5bb56190fda39";this.collection.query=t,this.collection.url=s,""!==t?this.collection.fetch({data:$.param({phrase:t,cal_min:0,cal_max:5e4,limit:10,results:{0:5},fields:"*"}),success:function(){i.render()},error:function(){console.log("Failed to fetch from Nutritionix API")}}):(i.collection.reset(),i.render())},resetSearch:function(e){e.preventDefault(),$("input").val(""),this.collection.reset(),this.render()}});
var app=app||{};app.ListitemView=Backbone.View.extend({tagName:"li",template:_.template($("#listitemTemplate").html()),render:function(){return this.$el.html(this.template(this.model)),this},events:{"click .addToMyFood":"addToMyFood","click .delete":"deleteItem"},addToMyFood:function(){var e=this.model,t=e._id;app.myfoodlist.get(t)||app.myfoodlist.add(e)},deleteItem:function(){this.model.destroy(),this.remove()}});
var app=app||{};app.MainView=Backbone.View.extend({el:$("#healthTracker"),events:{},initialize:function(){},render:function(){}});
var app=app||{};app.MyFoodView=Backbone.View.extend({tagName:"li",template:_.template($("#myfooditemTemplate").html()),initialize:function(){this.listenTo(this.model,"change",this.render)},render:function(){return this.$el.html(this.template(this.model.attributes)),this},events:{"click .delete":"deleteItem"},deleteItem:function(){this.model.destroy(),this.remove()}});
var app=app||{};app.MyFoodListView=Backbone.View.extend({el:$("#myFood"),events:{},initialize:function(){this.listenTo(app.myfoodlist,"add",this.addOne)},render:function(){},addOne:function(e){var n=new app.MyFoodView({model:e});this.$el.append(n.render().el)}});
var app=app||{};$(function(){new app.MainView,new app.ListView,new app.MyFoodListView});